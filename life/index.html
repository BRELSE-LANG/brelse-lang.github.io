<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life in Weeks - Enhanced</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #fefcf7;
            color: #2c3e50;
            min-height: 100vh;
            padding: 2rem 1rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .title {
            font-size: 2.5rem;
            font-weight: 300;
            color: #0066ff;
            margin-bottom: 0.5rem;
            letter-spacing: -0.02em;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #666;
            font-weight: 300;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 3rem;
            flex-wrap: wrap;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .input-group label {
            font-size: 0.9rem;
            color: #666;
            font-weight: 400;
        }

        .input-group input, .input-group select {
            padding: 0.75rem 1rem;
            border: 2px solid #e8e8e8;
            border-radius: 8px;
            background: white;
            font-size: 1rem;
            min-width: 120px;
            text-align: center;
            transition: all 0.2s ease;
        }

        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #0066ff;
            box-shadow: 0 0 0 3px rgba(0, 102, 255, 0.1);
        }

        .view-modes {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .view-mode {
            padding: 0.5rem 1rem;
            border: 2px solid #e8e8e8;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .view-mode.active {
            border-color: #0066ff;
            background: #0066ff;
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 600;
            color: #0066ff;
            display: block;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        .stat-detail {
            font-size: 0.8rem;
            color: #888;
            margin-top: 0.25rem;
        }

        .grid-container {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }

        .year-labels {
            display: flex;
            margin-bottom: 1rem;
            padding-left: 3rem;
        }

        .year-label {
            width: calc(52 * 8px + 52 * 2px);
            text-align: center;
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
        }

        .grid-row {
            display: flex;
            align-items: center;
            margin-bottom: 2px;
        }

        .age-label {
            width: 3rem;
            text-align: right;
            font-size: 0.8rem;
            color: #666;
            margin-right: 1rem;
        }

        .weeks-row {
            display: flex;
            gap: 2px;
        }

        .week {
            width: 8px;
            height: 8px;
            border-radius: 1px;
            transition: all 0.2s ease;
            cursor: pointer;
            position: relative;
        }

        .week.lived {
            background: #0066ff;
        }

        .week.current {
            background: #0066ff;
            box-shadow: 0 0 8px rgba(0, 102, 255, 0.6);
            transform: scale(1.2);
        }

        .week.future {
            background: #f0f0f0;
            border: 1px solid #e0e0e0;
        }

        /* Data overlay styles */
        .week.season-spring { border-top: 2px solid #4CAF50; }
        .week.season-summer { border-top: 2px solid #FF9800; }
        .week.season-autumn { border-top: 2px solid #F44336; }
        .week.season-winter { border-top: 2px solid #2196F3; }

        .week.milestone::after {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 4px;
            height: 4px;
            background: #FFD700;
            border-radius: 50%;
        }

        .week:hover {
            transform: scale(1.4);
            z-index: 10;
            position: relative;
        }

        .legend {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
            font-size: 0.9rem;
            flex-wrap: wrap;
        }

        .legend-section {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            align-items: center;
        }

        .legend-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }

        .legend-color.lived { background: #0066ff; }
        .legend-color.current { background: #0066ff; box-shadow: 0 0 6px rgba(0, 102, 255, 0.6); }
        .legend-color.future { background: #f0f0f0; border: 1px solid #e0e0e0; }
        .legend-color.spring { background: #4CAF50; }
        .legend-color.summer { background: #FF9800; }
        .legend-color.autumn { background: #F44336; }
        .legend-color.winter { background: #2196F3; }
        .legend-color.milestone { background: #FFD700; border-radius: 50%; }

        .insights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .insight-card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .insight-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #0066ff;
            margin-bottom: 1rem;
        }

        .insight-list {
            list-style: none;
            line-height: 1.6;
        }

        .insight-list li {
            margin-bottom: 0.5rem;
            color: #555;
        }

        .tooltip {
            position: fixed;
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 1rem;
            border-radius: 8px;
            font-size: 0.85rem;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s ease;
            max-width: 300px;
            line-height: 1.4;
        }

        @media (max-width: 768px) {
            .title { font-size: 2rem; }
            .controls { gap: 1rem; }
            .stats-grid { grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); }
            .grid-container { padding: 1rem; overflow-x: auto; }
            .year-labels, .grid-row { min-width: 600px; }
            .legend { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">Life in Weeks</h1>
            <p class="subtitle">Your life journey through time, seasons, and changing world</p>
        </div>

        <div class="controls">
            <div class="input-group">
                <label for="birthDate">Birth Date</label>
                <input type="date" id="birthDate" value="1990-01-01">
            </div>
            <div class="input-group">
                <label for="lifeExpectancy">Life Expectancy</label>
                <input type="number" id="lifeExpectancy" value="80" min="50" max="120">
            </div>
            <div class="input-group">
                <label for="birthLocation">Birth Location</label>
                <select id="birthLocation">
                    <option value="global">Global</option>
                    <option value="north">Northern Hemisphere</option>
                    <option value="south">Southern Hemisphere</option>
                </select>
            </div>
        </div>

        <div class="view-modes">
            <div class="view-mode active" data-mode="basic">Basic View</div>
            <div class="view-mode" data-mode="seasons">Seasons</div>
            <div class="view-mode" data-mode="population">World Population</div>
            <div class="view-mode" data-mode="milestones">Life Milestones</div>
        </div>

        <div class="stats-grid" id="statsGrid">
            <!-- Stats will be populated by JavaScript -->
        </div>

        <div class="grid-container">
            <div class="year-labels" id="yearLabels"></div>
            <div class="grid" id="grid"></div>
        </div>

        <div class="legend" id="legend">
            <!-- Legend will be populated by JavaScript -->
        </div>

        <div class="insights" id="insights">
            <!-- Insights will be populated by JavaScript -->
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        class EnhancedLifeInWeeks {
            constructor() {
                this.birthDate = new Date('1990-01-01');
                this.lifeExpectancy = 80;
                this.birthLocation = 'global';
                this.today = new Date();
                this.currentMode = 'basic';
                
                this.worldData = {
                    populationGrowth: {
                        1990: 5.3, 2000: 6.1, 2010: 6.9, 2020: 7.8, 2030: 8.5, 2040: 9.2, 2050: 9.7
                    },
                    climateData: {
                        avgTempIncrease: 0.18, // per decade
                        co2Levels: { 1990: 354, 2020: 414, 2050: 480 }
                    },
                    techMilestones: {
                        1991: "World Wide Web launched",
                        1995: "Amazon founded", 
                        1998: "Google founded",
                        2004: "Facebook launched",
                        2007: "iPhone released",
                        2010: "Instagram launched",
                        2016: "AlphaGo beats world champion",
                        2020: "COVID-19 pandemic",
                        2022: "ChatGPT launched"
                    },
                    lifeMilestones: {
                        0: "Birth", 1: "First words", 5: "School starts", 16: "Driving age",
                        18: "Legal adult", 22: "College graduation", 25: "Brain fully developed",
                        30: "Career peak begins", 40: "Midlife", 50: "Empty nest", 
                        65: "Retirement age", 70: "Wisdom years"
                    }
                };
                
                this.initEventListeners();
                this.updateVisualization();
            }

            initEventListeners() {
                const birthDateInput = document.getElementById('birthDate');
                const lifeExpectancyInput = document.getElementById('lifeExpectancy');
                const birthLocationInput = document.getElementById('birthLocation');

                birthDateInput.addEventListener('change', (e) => {
                    this.birthDate = new Date(e.target.value);
                    this.updateVisualization();
                });

                lifeExpectancyInput.addEventListener('input', (e) => {
                    this.lifeExpectancy = parseInt(e.target.value);
                    this.updateVisualization();
                });

                birthLocationInput.addEventListener('change', (e) => {
                    this.birthLocation = e.target.value;
                    this.updateVisualization();
                });

                const viewModes = document.querySelectorAll('.view-mode');
                viewModes.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        viewModes.forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentMode = e.target.dataset.mode;
                        this.updateVisualization();
                    });
                });
            }

            getWeeksDifference(date1, date2) {
                const diffTime = Math.abs(date2 - date1);
                return Math.floor(diffTime / (1000 * 60 * 60 * 24 * 7));
            }

            getCurrentWeek() {
                return this.getWeeksDifference(this.birthDate, this.today);
            }

            getTotalWeeks() {
                return this.lifeExpectancy * 52;
            }

            getSeasonFromWeek(weekNumber, location) {
                const weekInYear = weekNumber % 52;
                
                if (location === 'south') {
                    if (weekInYear >= 36 || weekInYear <= 11) return 'summer';
                    if (weekInYear >= 12 && weekInYear <= 23) return 'autumn';
                    if (weekInYear >= 24 && weekInYear <= 35) return 'winter';
                    return 'spring';
                } else {
                    if (weekInYear >= 10 && weekInYear <= 23) return 'spring';
                    if (weekInYear >= 24 && weekInYear <= 37) return 'summer';
                    if (weekInYear >= 38 && weekInYear <= 49) return 'autumn';
                    return 'winter';
                }
            }

            getWorldPopulation(year) {
                const data = this.worldData.populationGrowth;
                const years = Object.keys(data).map(Number).sort();
                
                if (year <= years[0]) return data[years[0]];
                if (year >= years[years.length - 1]) return data[years[years.length - 1]];
                
                for (let i = 0; i < years.length - 1; i++) {
                    if (year >= years[i] && year < years[i + 1]) {
                        const ratio = (year - years[i]) / (years[i + 1] - years[i]);
                        return data[years[i]] + (data[years[i + 1]] - data[years[i]]) * ratio;
                    }
                }
                return data[years[0]];
            }

            updateStats() {
                const currentWeek = this.getCurrentWeek();
                const totalWeeks = this.getTotalWeeks();
                const remainingWeeks = totalWeeks - currentWeek;
                const percentLived = Math.round((currentWeek / totalWeeks) * 100);
                
                const currentYear = new Date().getFullYear();
                const birthYear = this.birthDate.getFullYear();
                const currentAge = currentYear - birthYear;
                
                // Calculate various life statistics
                const totalSeasons = this.lifeExpectancy * 4;
                const seasonsLived = currentAge * 4 + Math.floor((new Date().getMonth() + 1) / 3);
                const totalMondays = this.lifeExpectancy * 52;
                const mondaysLived = currentWeek;
                
                // World population stats
                const birthPopulation = this.getWorldPopulation(birthYear);
                const currentPopulation = this.getWorldPopulation(currentYear);
                const populationGrowth = ((currentPopulation - birthPopulation) / birthPopulation * 100).toFixed(1);

                const stats = [
                    {
                        number: totalWeeks.toLocaleString(),
                        label: 'Total Weeks',
                        detail: `${(totalWeeks/1000).toFixed(1)}K weeks to live`
                    },
                    {
                        number: currentWeek.toLocaleString(),
                        label: 'Weeks Lived',
                        detail: `${percentLived}% of life completed`
                    },
                    {
                        number: remainingWeeks.toLocaleString(),
                        label: 'Weeks Remaining',
                        detail: `${Math.round(remainingWeeks/52)} years left`
                    },
                    {
                        number: totalSeasons,
                        label: 'Total Seasons',
                        detail: `${seasonsLived} seasons experienced`
                    },
                    {
                        number: totalMondays,
                        label: 'Total Mondays',
                        detail: `${mondaysLived} Mondays so far`
                    },
                    {
                        number: `${birthPopulation.toFixed(1)}B`,
                        label: 'Birth Population',
                        detail: `Now ${currentPopulation.toFixed(1)}B (+${populationGrowth}%)`
                    }
                ];

                const statsGrid = document.getElementById('statsGrid');
                statsGrid.innerHTML = stats.map(stat => `
                    <div class="stat-card">
                        <span class="stat-number">${stat.number}</span>
                        <span class="stat-label">${stat.label}</span>
                        <div class="stat-detail">${stat.detail}</div>
                    </div>
                `).join('');
            }

            createYearLabels() {
                const yearLabels = document.getElementById('yearLabels');
                yearLabels.innerHTML = '';
                
                const decades = Math.ceil(this.lifeExpectancy / 10);
                for (let decade = 0; decade < decades; decade++) {
                    const label = document.createElement('div');
                    label.className = 'year-label';
                    label.textContent = (decade * 10) + '–' + Math.min((decade * 10) + 9, this.lifeExpectancy);
                    yearLabels.appendChild(label);
                }
            }

            createGrid() {
                const grid = document.getElementById('grid');
                const currentWeek = this.getCurrentWeek();
                const birthYear = this.birthDate.getFullYear();
                
                grid.innerHTML = '';

                for (let age = 0; age < this.lifeExpectancy; age++) {
                    const row = document.createElement('div');
                    row.className = 'grid-row';

                    const ageLabel = document.createElement('div');
                    ageLabel.className = 'age-label';
                    ageLabel.textContent = age;
                    row.appendChild(ageLabel);

                    const weeksRow = document.createElement('div');
                    weeksRow.className = 'weeks-row';

                    for (let week = 0; week < 52; week++) {
                        const weekNumber = age * 52 + week;
                        const weekEl = document.createElement('div');
                        weekEl.className = 'week';
                        const currentYear = birthYear + age;

                        // Basic week state
                        if (weekNumber < currentWeek) {
                            weekEl.classList.add('lived');
                        } else if (weekNumber === currentWeek) {
                            weekEl.classList.add('current');
                        } else {
                            weekEl.classList.add('future');
                        }

                        // Add data overlays based on current mode
                        if (this.currentMode === 'seasons') {
                            const season = this.getSeasonFromWeek(weekNumber, this.birthLocation);
                            weekEl.classList.add(`season-${season}`);
                        }

                        if (this.currentMode === 'milestones' && this.worldData.lifeMilestones[age]) {
                            weekEl.classList.add('milestone');
                        }

                        weekEl.addEventListener('mouseenter', (e) => {
                            this.showTooltip(e, age, week, weekNumber, currentWeek, currentYear);
                        });

                        weekEl.addEventListener('mouseleave', () => {
                            this.hideTooltip();
                        });

                        weeksRow.appendChild(weekEl);
                    }

                    row.appendChild(weeksRow);
                    grid.appendChild(row);
                }
            }

            showTooltip(e, age, week, weekNumber, currentWeek, year) {
                const tooltip = document.getElementById('tooltip');
                const weekDate = new Date(this.birthDate);
                weekDate.setDate(weekDate.getDate() + (weekNumber * 7));
                
                let status = weekNumber < currentWeek ? 'Lived' : 
                            weekNumber === currentWeek ? 'Current Week' : 'Future';

                let content = `
                    <strong>Age ${age}, Week ${week + 1} (${year})</strong><br>
                    ${weekDate.toLocaleDateString()}<br>
                    Status: ${status}
                `;

                // Add mode-specific data
                if (this.currentMode === 'seasons') {
                    const season = this.getSeasonFromWeek(weekNumber, this.birthLocation);
                    content += `<br>Season: ${season.charAt(0).toUpperCase() + season.slice(1)}`;
                }

                if (this.currentMode === 'population') {
                    const population = this.getWorldPopulation(year);
                    content += `<br>World Population: ${population.toFixed(1)}B people`;
                }

                if (this.currentMode === 'milestones') {
                    if (this.worldData.lifeMilestones[age]) {
                        content += `<br><strong>Milestone:</strong> ${this.worldData.lifeMilestones[age]}`;
                    }
                    if (this.worldData.techMilestones[year]) {
                        content += `<br><strong>Tech:</strong> ${this.worldData.techMilestones[year]}`;
                    }
                }

                tooltip.innerHTML = content;
                tooltip.style.left = Math.min(e.pageX + 10, window.innerWidth - 320) + 'px';
                tooltip.style.top = e.pageY - 10 + 'px';
                tooltip.style.opacity = '1';
            }

            hideTooltip() {
                document.getElementById('tooltip').style.opacity = '0';
            }

            updateLegend() {
                const legend = document.getElementById('legend');
                
                const basicLegend = `
                    <div class="legend-section">
                        <div class="legend-title">Life Status</div>
                        <div class="legend-item">
                            <div class="legend-color lived"></div>
                            <span>Weeks Lived</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color current"></div>
                            <span>Current Week</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color future"></div>
                            <span>Future Weeks</span>
                        </div>
                    </div>
                `;

                let modeSpecificLegend = '';
                
                if (this.currentMode === 'seasons') {
                    modeSpecificLegend = `
                        <div class="legend-section">
                            <div class="legend-title">Seasons</div>
                            <div class="legend-item">
                                <div class="legend-color spring"></div>
                                <span>Spring</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color summer"></div>
                                <span>Summer</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color autumn"></div>
                                <span>Autumn</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color winter"></div>
                                <span>Winter</span>
                            </div>
                        </div>
                    `;
                }

                if (this.currentMode === 'milestones') {
                    modeSpecificLegend = `
                        <div class="legend-section">
                            <div class="legend-title">Milestones</div>
                            <div class="legend-item">
                                <div class="legend-color milestone"></div>
                                <span>Life Milestone</span>
                            </div>
                        </div>
                    `;
                }

                legend.innerHTML = basicLegend + modeSpecificLegend;
            }

            updateInsights() {
                const insights = document.getElementById('insights');
                const currentAge = Math.floor(this.getCurrentWeek() / 52);
                const birthYear = this.birthDate.getFullYear();
                const currentYear = new Date().getFullYear();
                
                const insightData = [
                    {
                        title: 'Your Lifetime in Context',
                        items: [
                            `You've experienced ${currentAge * 4} seasons so far`,
                            `You've lived through ${currentYear - birthYear} calendar years`,
                            `You've seen ${Math.floor(currentAge / 10)} decades pass`,
                            `You have approximately ${Math.floor((this.lifeExpectancy - currentAge) / 10)} decades remaining`
                        ]
                    },
                    {
                        title: 'World Population During Your Life',
                        items: [
                            `Born when world population was ${this.getWorldPopulation(birthYear).toFixed(1)} billion`,
                            `Current world population: ${this.getWorldPopulation(currentYear).toFixed(1)} billion`,
                            `Population has grown by ${((this.getWorldPopulation(currentYear) - this.getWorldPopulation(birthYear)) * 1000).toFixed(0)} million in your lifetime`,
                            `By age 80, world population may reach ${this.getWorldPopulation(birthYear + 80).toFixed(1)} billion`
                        ]
                    },
                    {
                        title: 'Climate & Environment',
                        items: [
                            `Global temperature has risen ~${((currentYear - birthYear) * 0.018).toFixed(2)}°C since your birth`,
                            `CO₂ levels were ~${this.worldData.climateData.co2Levels[1990] || 354}ppm when you were born`,
                            `Current CO₂ levels: ~${this.worldData.climateData.co2Levels[2020]}ppm`,
                            `You'll likely see significant climate changes in your lifetime`
                        ]
                    },
                    {
                        title: 'Perspective on Time',
                        items: [
                            `Each week represents ${(100/this.getTotalWeeks()).toFixed(3)}% of your entire life`,
                            `A year is ${(52/this.getTotalWeeks()*100).toFixed(1)}% of your total weeks`,
                            `You have roughly ${Math.floor(this.getTotalWeeks()/365.25)} days per week of your life`,
                            `Every 5 years represents ${(260/this.getTotalWeeks()*100).toFixed(1)}% of your total time`
                        ]
                    }
                ];

                insights.innerHTML = insightData.map(section => `
                    <div class="insight-card">
                        <div class="insight-title">${section.title}</div>
                        <ul class="insight-list">
                            ${section.items.map(item => `<li>${item}</li>`).join('')}
                        </ul>
                    </div>
                `).join('');
            }

            updateVisualization() {
                this.updateStats();
                this.createYearLabels();
                this.createGrid();
                this.updateLegend();
                this.updateInsights();
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            new EnhancedLifeInWeeks();
        });
    </script>
</body>
</html>
